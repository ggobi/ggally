---
title: "DM2_issue"
output: html_document
---

## Load packages

```{r}
# Load required libraries
library(effects)    # For the Arrests dataset
library(ggplot2)    # For creating graphics
library(GGally)     # For advanced data visualization
library(patchwork)  # For combining multiple ggplot2 plots
```

## The Plot

```{r}
# Load the Arrests dataset
data(Arrests)

# Function to create histograms for continuous variables
# This function takes the dataset and a variable name as input
plot_continuous <- function(data, x_var) {
  # Create a histogram showing distribution of a continuous variable
  # Colored by 'released' status to show relationship
  ggplot(data, aes_string(x = x_var)) +
    # Create histogram with 20 bins, separated by 'released' status
    geom_histogram(aes(fill = released), bins = 20, position = "dodge") +
    # Add informative labels
    labs(title = paste(x_var, "vs Released"),
         x = x_var,
         y = "Count") +
    # Use a clean, minimal theme
    theme_minimal() +
    # Rotate x-axis labels for better readability
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

# Function to create bar plots for categorical variables
plot_categorical <- function(data, x_var) {
  # Create a bar plot showing distribution of a categorical variable
  # Colored by 'released' status to show relationship
  ggplot(data, aes_string(x = x_var, fill = "released")) +
    # Create bar plot with bars side by side
    geom_bar(position = "dodge") +
    # Add informative labels
    labs(title = paste(x_var, "vs released"),
         x = x_var,
         y = "Count") +
    # Use a clean, minimal theme
    theme_minimal() +
    # Rotate x-axis labels for better readability
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

# Continuous variables are numeric
continuous_vars <- sapply(Arrests, is.numeric)
# Categorical variables are factors
categorical_vars <- sapply(Arrests, is.factor)

# Create plots for continuous variables
# Use lapply to apply the plotting function to each continuous variable
cont_plots <- lapply(names(Arrests)[continuous_vars], function(var) plot_continuous(Arrests, var))

# Create plots for categorical variables
# Use lapply to apply the plotting function to each categorical variable
cat_plots <- lapply(names(Arrests)[categorical_vars], function(var) plot_categorical(Arrests, var))

# Combine all plots using patchwork
# Reduce function helps to add multiple plots together
final_plot <- Reduce(`+`, c(cont_plots, cat_plots)) +
  # Arrange plots in 3 columns and collect legends
  plot_layout(ncol = 3, guides = "collect")

# Display the final combined plot
print(final_plot)
```

```{r}
library(GGally)
library(ggplot2)

# Charger les données
data(Arrests)

# Sélectionner uniquement 'released' et les autres variables
selected_vars <- c("released", setdiff(names(Arrests), "released"))

# Créer un ggpairs avec une seule colonne (1, N)
custom_plot <- ggpairs(Arrests,
                       columns = 1:length(selected_vars),  # Exclure 'released' des X
                       mapping = aes(color = released),  # Coloration par released
                       lower = list(continuous = wrap("points", alpha = 0.6), 
                                    combo = wrap("box_no_facet"),
                                    discrete = wrap("facetbar")),
                       diag = list(continuous = wrap("densityDiag")),  # Histogrammes en diag
                       upper = list(continuous = "blank", combo = "blank", discrete = "blank")  # Supprimer la partie supérieure
)

# Afficher le plot
print(custom_plot)

```
